{
    "collab_server" : "",
    "contents" : "library(shiny)\nlibrary(shinydashboard)\nlibrary(forecast)\nlibrary(plotly)\nlibrary(fredr)\nlibrary(DT)\nlibrary(dygraphs)\nlibrary(zoo)\nlibrary(lubridate)\n\nkey <- \"0e510a57a0086df706ac9c8fb852b706\"\n\nunempTabs <- c(\"plot.unemp\",\"unempSummary\", \n               \"unempForecastTable\",\"unempResiduals\")\npayempTabs <- c(\"plot.payemp\",\"payempSummary\",\n                \"payempForecastTable\",\"payempResiduals\")\ngdpTabs <- c(\"plot.gdp\",\"gdpSummary\",\n             \"gdpForecastTable\",\"gdpResiduals\")\ncpiTabs <- c(\"plot.cpi\",\"cpiSummary\",\n             \"cpiForecastTable\",\"cpiResiduals\")\n\nfitModel <- function(seriesID){\n  # currently only fitting ARIMA models\n  if(seriesID == \"UNRATE\"){\n    auto.arima(fredr_series(series_id = \"UNRATE\"))\n  } else if(seriesID == \"PAYEMS\"){\n    auto.arima(fredr_series(series_id = \"PAYEMS\"))\n  } else if(seriesID == \"A191RL1Q225SBEA\"){\n    auto.arima(fredr_series(series_id = \"A191RL1Q225SBEA\"))\n  } else if(seriesID == \"CPIAUCSL\"){\n    auto.arima(fredr_series(series_id = \"CPIAUCSL\"))\n  }\n}\ngen_array <- function(forecast_obj){\n  \n  actuals <- forecast_obj$x\n  lower <- forecast_obj$lower[,2]\n  upper <- forecast_obj$upper[,2]\n  point_forecast <- forecast_obj$mean\n  \n  cbind(actuals, lower, upper, point_forecast)\n}\nplotModel <- function(ts_array, series_name){\n    \n    if(series_name==\"UNRATE\"){\n      graph_title <- \"Unemployment Rate\"\n    } else if(series_name==\"PAYEMS\"){\n        graph_title <- \"Payroll Employment\"\n    } else if(series_name==\"A191RL1Q225SBEA\"){\n        graph_title <- \"GDP Growth Rate\"\n    } else {\n        graph_title <- \"Consumer Price Index\"\n    }\n  \n    dygraph(ts_array, main = graph_title) %>% \n      dyRangeSelector() %>% \n      dyRangeSelector(height = 40,\n                      dateWindow = c(\"2011-04-01\", \"2019-4-01\")) %>%\n      dySeries(name = \"actuals\", label = \"actual\") %>%\n      dySeries(c(\"lower\",\"point_forecast\",\"upper\"), label = \"Predicted\") %>%\n      dyLegend(show = \"always\", hideOnMouseOut = FALSE) %>%\n      dyHighlight(highlightCircleSize = 5,\n                  highlightSeriesOpts = list(strokeWidth = 2)) %>%\n      dyOptions(#colors = c(\"#266DD3\",\"23F0C7\"),\n                axisLineColor = \"navy\", gridLineColor = \"grey\")\n}\nforecastTable <- function(model){\n  fcst <- forecast(model)\n  \n  # assumes object is forecast model\n  if(grepl(\"UNRATE\", model$series) |\n     grepl(\"A191RL1Q225SBEA\", model$series)){\n    \n    fcst <- data.frame(fcst)\n    \n    fcst.dates <- row.names(fcst)\n    \n    fcst <- data.frame(sapply(fcst, function(x) round(x, 2)))\n    fcst$Date <- fcst.dates\n    \n    datatable(head(fcst), rownames = FALSE)\n    \n  } else if(grepl(\"CPIAUCSL\", model$series)){\n    \n    fcst <- data.frame(fcst)\n    \n    fcst.dates <- row.names(fcst)\n    \n    fcst <- data.frame(sapply(fcst, function(x) round(x, 1)))\n    fcst$Date <- fcst.dates\n    \n    datatable(head(fcst), rownames = FALSE)\n    \n  }  else if(grepl(\"PAYEMS\", model$series)){\n    fcst <- data.frame(fcst)\n    \n    fcst.dates <- row.names(fcst)\n    \n    fcst <- data.frame(sapply(fcst, function(x) round(x)))\n    fcst$Date <- fcst.dates\n    \n    datatable(head(fcst), rownames = FALSE)\n  }\n}\nwidget <- function(tabs){\n  \n  if(grepl(\"unemp\", tabs[1])){\n    tabBox(title = \"Unemployment Forecast\",\n           tabPanel(\"Model Summary\",\n                    verbatimTextOutput(tabs[2])),\n           tabPanel(\"Residuals\",\n                    plotOutput(tabs[4])),\n           width = 10)\n  } else if(grepl(\"payemp\", tabs[1])){\n    tabBox(title = \"Monthly Payroll Employment\",\n           tabPanel(\"Model Summary\",\n                    verbatimTextOutput(tabs[2])),\n           tabPanel(\"Forecast Table\",\n                    dataTableOutput(tabs[3])),\n           tabPanel(\"Residuals\",\n                    plotOutput(tabs[4])),\n           width = 10)\n  } else if(grepl(\"gdp\", tabs[1])){\n    tabBox(title = \"Quarterly GDP Growth Rate\",\n           tabPanel(\"Model Summary\",\n                    verbatimTextOutput(tabs[2])),\n           tabPanel(\"Forecast Table\",\n                    dataTableOutput(tabs[3])),\n           tabPanel(\"Residuals\",\n                    plotOutput(tabs[4])),\n           width = 10)\n  } else if(grepl(\"cpi\", tabs[1])){\n    tabBox(title = \"Consumer Price Index\",\n           tabPanel(\"Model Summary\",\n                    verbatimTextOutput(tabs[2])),\n           tabPanel(\"Forecast Table\",\n                    dataTableOutput(tabs[3])),\n           tabPanel(\"Residuals\",\n                    plotOutput(tabs[4])),\n           width = 10)\n  }\n}\n\n\n",
    "created" : 1488155973567.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1165419078",
    "id" : "FC2D9FBD",
    "lastKnownWriteTime" : 1493260182,
    "last_content_update" : 1493260182,
    "path" : "D:/Projects/fredcast/functions.R",
    "project_path" : "functions.R",
    "properties" : {
        "source_window_id" : "",
        "tempName" : "Untitled1"
    },
    "relative_order" : 3,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}